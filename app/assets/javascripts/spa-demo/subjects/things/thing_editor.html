<form name="thingform" class="thing-form row">
  <span class="thing_id id">{{$ctrl.item.id}}</span>
  <span class="invalid">{{$ctrl.item.errors.full_messages}}</span>

  <div class="thing-name row col-lg-12">
    <label class="col-xs-3">Name:</label>
    <input type="text" 
     class="col-xs-9" 
     name="thing-name" 
     ng-model="$ctrl.item.name" 
     ng-readonly="!$ctrl.authz.canUpdate" 
     maxlength="60"
     pattern=".{3,}"
     title="3 character minimum for Name"
     required="required"/>
    <span class="invalid">{{$ctrl.item.errors.name}}</span>
  </div>
  <div class="thing-desc row col-lg-12">
    <label class="col-xs-3">Description:</label>
    <textarea
     maxlength="4000" 
     class="col-xs-9"
     cols="30" 
     name="thing-desc" 
     ng-model="$ctrl.item.description" 
     ng-readonly="!$ctrl.authz.canUpdate" 
     title="3 character minimum for Description"/>
    <span class="invalid">{{$ctrl.item.errors.name}}</span>
  </div>
  <span ng-show="$ctrl.authz.canGetDetails">
    <div class="thing-notes row col-lg-12">
      <label class="col-xs-3">Notes:</label>
      <textarea
      maxlength="4000" 
      class="col-xs-9"
      cols="30" 
      name="thing-notes" 
      ng-model="$ctrl.item.notes" 
      ng-readonly="!$ctrl.authz.canUpdate" 
      title="3 character minimum for Notes"/>
      <span class="invalid">{{$ctrl.item.errors.name}}</span>
    </div>
  </span>

  <div class="thing-images row col-lg-12">
    <label class="col-xs-3">Related Images:</label>
    <ul class="thing-images col-xs-9">
      <li ng-repeat="ti in $ctrl.images | orderBy:'priority'">
        <input type="checkbox" 
               name="image-delete" 
               ng-model="ti.toRemove" 
               ng-show="$ctrl.authz.canRemoveImage" 
               value="{{ti.id}}"/>
        <div class="image-delete glyphicon glyphicon-remove" ng-show="ti.toRemove"></div>
        <input type="number" 
               name="image-priority" 
               min="0" 
               max="9" 
               ng-show="$ctrl.authz.canUpdateImage && !ti.toRemove"
               ng-model="ti.priority"/>
        <div class="glyphicon glyphicon-asterisk" 
             ng-hide="ti.originalPriority==ti.priority || ti.toRemove"></div>
        <a data-ui-sref="images({id: ti.image_id})">
          <img sytle="width:50px" ng-src="{ti.image_content_url}?with=50"/>
          <span class="id image_id">{{ti.image_id}}</span>
          <label for="" class="image-caption" ng-show="ti.image_caption">{{ti.image_caption}}</label>
          <label for="" class="image-caption" ng-hide="ti.image_caption">no caption{{ti.image_caption}}</label>
        </a>
      </li>
    </ul>
    <span class="invalid">{{$ctrl.item.errors.images}}</span>
  </div>

  <div class="thing-controls">
    <span ng-show="$ctrl.authz.authenticated">
      <button name="thing-create" 
       ng-show="!$ctrl.item.id && $ctrl.authz.canCreate" 
       type="submit" 
       ng-disabled="thingform.$invalid" 
       ng-click="$ctrl.create()">Create Thing</button>

      <span ng-show="$ctrl.item.id">
        <span class="thing-modify" data-ng-hide="!$ctrl.authz.canUpdate">
            <button name="thing-update"
            type="submit" 
            ng-disabled="!thingform.$dirty || thingform.$invalid"
            data-ng-hide="$ctrl.haveDirtyLinks() &&
                        (!thingform['thing-name'].$dirty && 
                         !thingform['thing-desc'].$dirty && 
                         !thingform['thing-notes'].$dirty)" 
            ng-click="$ctrl.update()">Update Thing</button>
            
            <button name="thing-images-update"
            type="submit" 
            data-ng-show="$ctrl.haveDirtyLinks() &&
                        (!thingform['thing-name'].$dirty && 
                         !thingform['thing-desc'].$dirty && 
                         !thingform['thing-notes'].$dirty)" 
            ng-click="$ctrl.update()">Update Image Links</button>
        </span>

        <button name="thing-delete" 
          type="submit" 
          ng-show="$ctrl.authz.canDelete" 
          ng-click="$ctrl.remove()">Delete Thing</button>
      </span>
      
      <button name="thing-clear" 
      type="submit" 
      ng-show="$ctrl.item.id || thingform.$dirty" 
      ng-click="$ctrl.clear()">Clear Thing</button>
    </span>
  </div>
</form>